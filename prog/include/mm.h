#ifndef _MM_H__
#define _MM_H__

#include "type.h"

#define PDE_PRESENT_MASK        0x00000001  // 0000 0000 0000 0000 0000 0000 0000 0001
#define PDE_RW_MASK             0x00000002  // 0000 0000 0000 0000 0000 0000 0000 0010
#define PDE_US_MASK             0x00000004  // 0000 0000 0000 0000 0000 0000 0000 0100
#define PDE_PWT_MASK            0x00000008  // 0000 0000 0000 0000 0000 0000 0000 1000
#define PDE_PCD_MASK            0x00000010  // 0000 0000 0000 0000 0000 0000 0001 0000
#define PDE_ACCESSED_MASK       0x00000020  // 0000 0000 0000 0000 0000 0000 0010 0000
#define PDE_RESERVED_MASK       0x00000040  // 0000 0000 0000 0000 0000 0000 0100 0000
#define PDE_PAGE_SIZE_MASK      0x00000080  // 0000 0000 0000 0000 0000 0000 1000 0000
#define PDE_GLOBAL_MASK         0x00000100  // 0000 0000 0000 0000 0000 0001 0000 0000
#define PDE_OSY_TYPE_MASK       0x00000E00  // 0000 0000 0000 0000 0000 1110 0000 0000
#define PDE_BASE_ADDR_MASK      0xFFFFF000  // 1111 1111 1111 1111 1111 0000 0000 0000

#define PDE_OSY_TYPE_NOT_EXIST  (0 << 9)
#define PDE_OSY_TYPE_AVAILABLE  (1 << 9)
#define PDE_OSY_TYPE_OCCUPIED   (2 << 9)


#define PTE_PRESENT_MASK        0x00000001  // 0000 0000 0000 0000 0000 0000 0000 0001
#define PTE_RW_MASK             0x00000002  // 0000 0000 0000 0000 0000 0000 0000 0010
#define PTE_US_MASK             0x00000004  // 0000 0000 0000 0000 0000 0000 0000 0100
#define PTE_PWT_MASK            0x00000008  // 0000 0000 0000 0000 0000 0000 0000 1000
#define PTE_PCD_MASK            0x00000010  // 0000 0000 0000 0000 0000 0000 0001 0000
#define PTE_ACCESSED_MASK       0x00000020  // 0000 0000 0000 0000 0000 0000 0010 0000
#define PTE_DIRTY_MASK          0x00000040  // 0000 0000 0000 0000 0000 0000 0100 0000
#define PTE_PAT_MASK            0x00000080  // 0000 0000 0000 0000 0000 0000 1000 0000
#define PTE_GLOBAL_MASK         0x00000100  // 0000 0000 0000 0000 0000 0001 0000 0000
#define PTE_OSY_TYPE_MASK       0x00000E00  // 0000 0000 0000 0000 0000 1110 0000 0000
#define PTE_BASE_ADDR_MASK      0xFFFFF000  // 1111 1111 1111 1111 1111 0000 0000 0000

#define PTE_OSY_TYPE_NOT_EXIST  (0 << 9)
#define PTE_OSY_TYPE_AVAILABLE  (1 << 9)
#define PTE_OSY_TYPE_OCCUPIED   (2 << 9)

typedef struct{
    uint32_t pde[1024];
    uint32_t pte[1024 * 1024];
}Page_Table;


#define PROCESS_MEM_BASE            0x00A00000
#define PROCESS_IMAGE_MEM_DEFAULT   0x00100000

void mm_main();

#endif